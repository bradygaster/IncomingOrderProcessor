{
  "version": "1.0",
  "generated_at": "2026-01-16T14:05:21.439340",
  "repository": "repo",
  "complexity_score": 5,
  "total_tasks": 11,
  "estimated_hours": 7.666666666666667,
  "phases": [
    "assess",
    "transform",
    "validate",
    "deploy"
  ],
  "detected_patterns": [
    "windows_service",
    "msmq"
  ],
  "tasks": [
    {
      "id": "assess-000-assess_repository",
      "title": "Initial Repository Assessment",
      "description": "Analyze repository for legacy patterns and modernization opportunities",
      "phase": "assess",
      "order": 0,
      "status": "completed",
      "instructions": [
        "### Static Analysis",
        "Run static analysis on all solution files (.sln)",
        "Parse project files (.csproj, .vbproj) for target frameworks",
        "Identify SDK-style vs legacy project formats",
        "### Pattern Detection",
        "Scan for legacy patterns (WCF, Windows Service, WebForms, etc.)",
        "Detect Entity Framework version (EF6 vs EF Core)",
        "Identify message queue usage (MSMQ, RabbitMQ, etc.)",
        "Find COM interop and P/Invoke usage",
        "### Dependency Analysis",
        "Catalog all NuGet packages and versions",
        "Identify deprecated or vulnerable packages",
        "Map project-to-project dependencies",
        "Document external service connections",
        "### Report Generation",
        "Calculate complexity score based on findings",
        "Generate assessment report in .modernization/ASSESSMENT.md",
        "Create JSON output for programmatic consumption"
      ],
      "acceptance_criteria": [
        "Assessment report generated in .modernization/ASSESSMENT.md",
        "All solution files analyzed",
        "All projects in solution cataloged",
        "Legacy patterns documented with file locations",
        "Complexity score calculated"
      ],
      "files_to_modify": [],
      "files_to_create": [
        ".modernization/ASSESSMENT.md",
        ".modernization/assessment.json"
      ],
      "depends_on": [],
      "blocks": [],
      "estimated_minutes": 15,
      "agent_hint": "Automated analysis - run detection tools",
      "template_id": "assess-repository",
      "started_at": null,
      "completed_at": "2026-01-16T14:05:21.439268",
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "transform-001-upgrade_dotnet",
      "title": "Upgrade to .NET 10",
      "description": "Upgrade all projects to .NET 10 LTS\n\nProjects to upgrade: IncomingOrderProcessor (v4.8.1)",
      "phase": "transform",
      "order": 1,
      "status": "pending",
      "instructions": [
        "### Update Project Files",
        "For each project file (.csproj):",
        "  1. Update <TargetFramework> to net10.0",
        "  2. Remove any <RuntimeIdentifier> if not needed",
        "  3. Update <LangVersion> to 'latest' or remove for default",
        "  4. Ensure <ImplicitUsings>enable</ImplicitUsings>",
        "  5. Ensure <Nullable>enable</Nullable>",
        "### Update NuGet Packages",
        "Run 'dotnet outdated' to identify updates needed",
        "Update Microsoft.* packages to 10.x versions",
        "Update Microsoft.Extensions.* to 10.x",
        "Update third-party packages to .NET 10 compatible versions",
        "Remove any packages now built into .NET 10",
        "### Handle Breaking Changes",
        "Review https://learn.microsoft.com/dotnet/core/compatibility/10.0",
        "Fix any nullable reference type warnings",
        "Update deprecated API calls",
        "Replace obsolete packages with modern equivalents",
        "### Verify Upgrade",
        "Run 'dotnet build' to check for errors",
        "Run 'dotnet test' to verify functionality",
        "Review and fix any new warnings"
      ],
      "acceptance_criteria": [
        "All projects target net10.0",
        "No packages.config files (use PackageReference)",
        "All NuGet packages updated to compatible versions",
        "Solution builds without errors",
        "All tests pass",
        "No obsolete API warnings (or documented exceptions)"
      ],
      "files_to_modify": [
        "**/*.csproj",
        "**/Directory.Build.props",
        "**/Directory.Packages.props",
        "**/global.json"
      ],
      "files_to_create": [],
      "depends_on": [],
      "blocks": [],
      "estimated_minutes": 45,
      "agent_hint": "Good for coding agents - systematic file updates",
      "template_id": "upgrade-dotnet",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "transform-002-migrate_msmq_to_servicebus",
      "title": "Migrate MSMQ to Azure Service Bus",
      "description": "Replace MSMQ messaging with Azure Service Bus",
      "phase": "transform",
      "order": 2,
      "status": "pending",
      "instructions": [
        "### Add Azure Service Bus SDK",
        "Add NuGet package:",
        "  Azure.Messaging.ServiceBus",
        "Remove System.Messaging references if no longer needed",
        "### Create Service Bus Resources",
        "Create Azure Service Bus namespace (if not exists)",
        "Create queue or topic to replace MSMQ queue",
        "Configure appropriate tier (Basic, Standard, Premium)",
        "Note: This may require Azure portal or IaC (see skill for Bicep)",
        "### Update Configuration",
        "Add Service Bus connection string to configuration:",
        "```json\n{\n  \"ServiceBus\": {\n    \"ConnectionString\": \"<from-key-vault>\",\n    \"QueueName\": \"my-queue\"\n  }\n}\n```\n",
        "Store connection string in Azure Key Vault",
        "Use Managed Identity for authentication (preferred)",
        "### Migrate Producer Code",
        "Replace MessageQueue.Send with ServiceBusSender:",
        "```csharp\n// Before (MSMQ)\nusing var queue = new MessageQueue(@\".\\private$\\myqueue\");\nqueue.Send(myObject);\n\n// After (Service Bus)\nawait using var client = new ServiceBusClient(connectionString);\nvar sender = client.CreateSender(queueName);\nawait sender.SendMessageAsync(new ServiceBusMessage(JsonSerializer.Serialize(myObject)));\n```\n",
        "Use dependency injection for ServiceBusClient",
        "Implement retry policies",
        "### Migrate Consumer Code",
        "Replace MessageQueue.Receive with ServiceBusProcessor:",
        "```csharp\n// Before (MSMQ)\nusing var queue = new MessageQueue(@\".\\private$\\myqueue\");\nvar message = queue.Receive();\n\n// After (Service Bus)\nvar processor = client.CreateProcessor(queueName);\nprocessor.ProcessMessageAsync += async args =>\n{\n    var body = args.Message.Body.ToString();\n    await args.CompleteMessageAsync(args.Message);\n};\nawait processor.StartProcessingAsync();\n```\n",
        "Implement error handling with ProcessErrorAsync",
        "Configure max concurrent calls and prefetch",
        "### Handle Message Serialization",
        "Replace BinaryFormatter (security risk) with JSON serialization",
        "Use System.Text.Json or Newtonsoft.Json",
        "Define message contracts/DTOs",
        "Handle versioning for message schema changes"
      ],
      "acceptance_criteria": [
        "Azure.Messaging.ServiceBus package added",
        "Service Bus namespace and queue created",
        "Connection string stored in Key Vault",
        "Producer code sends to Service Bus",
        "Consumer code receives from Service Bus",
        "Error handling implemented",
        "Integration tests validate message flow"
      ],
      "files_to_modify": [
        "**/*Producer*.cs",
        "**/*Consumer*.cs",
        "**/*Queue*.cs",
        "**/*Message*.cs",
        "**/appsettings.json"
      ],
      "files_to_create": [
        "infrastructure/service-bus.bicep"
      ],
      "depends_on": [],
      "blocks": [],
      "estimated_minutes": 90,
      "agent_hint": "Add Service Bus SDK, replace MessageQueue with ServiceBusClient",
      "template_id": "migrate-msmq-to-servicebus",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "transform-003-migrate_windows_service",
      "title": "Migrate Windows Service to Worker Service",
      "description": "Convert Windows Service (ServiceBase) to .NET Worker Service",
      "phase": "transform",
      "order": 3,
      "status": "pending",
      "instructions": [
        "### Create Worker Service Project",
        "Create new Worker Service project:",
        "  dotnet new worker -n <ServiceName>.Worker",
        "Add project to solution:",
        "  dotnet sln add <ServiceName>.Worker",
        "Add required NuGet packages:",
        "  - Microsoft.Extensions.Hosting",
        "  - Microsoft.Extensions.Hosting.WindowsServices (if Windows deployment)",
        "  - Microsoft.Extensions.Hosting.Systemd (if Linux deployment)",
        "### Configure Program.cs",
        "Configure host builder with dependency injection",
        "Add services.AddHostedService<Worker>()",
        "Add UseWindowsService() or UseSystemd() for OS integration",
        "Configure logging with Serilog or built-in logging",
        "Add configuration from appsettings.json",
        "Example:\n```csharp\nvar builder = Host.CreateApplicationBuilder(args);\nbuilder.Services.AddHostedService<Worker>();\nbuilder.Services.AddWindowsService(); // Optional\nvar host = builder.Build();\nhost.Run();\n```\n",
        "### Migrate Service Logic",
        "Create Worker class inheriting from BackgroundService",
        "Move OnStart() logic to ExecuteAsync() or StartAsync()",
        "Move OnStop() logic to StopAsync() or use CancellationToken",
        "Replace Timer with PeriodicTimer or Task.Delay loop:",
        "```csharp\nprotected override async Task ExecuteAsync(CancellationToken stoppingToken)\n{\n    using var timer = new PeriodicTimer(TimeSpan.FromSeconds(30));\n    while (await timer.WaitForNextTickAsync(stoppingToken))\n    {\n        await DoWorkAsync(stoppingToken);\n    }\n}\n```\n",
        "Convert synchronous code to async/await",
        "Replace Thread.Sleep with await Task.Delay",
        "### Migrate Configuration",
        "Move app.config settings to appsettings.json",
        "Use IOptions<T> pattern for configuration",
        "Replace ConfigurationManager with IConfiguration",
        "Add environment-specific config (appsettings.Development.json)",
        "### Add Observability",
        "Inject ILogger<Worker> for logging",
        "Add health checks endpoint if needed",
        "Configure Application Insights or preferred telemetry"
      ],
      "acceptance_criteria": [
        "New Worker project created and added to solution",
        "Project targets net10.0",
        "BackgroundService implementation complete",
        "All business logic migrated from ServiceBase",
        "Configuration migrated to appsettings.json",
        "Logging configured with ILogger",
        "Project builds successfully",
        "Service starts and stops cleanly"
      ],
      "files_to_modify": [
        "**/appsettings.json"
      ],
      "files_to_create": [
        "src/<ServiceName>.Worker/<ServiceName>.Worker.csproj",
        "src/<ServiceName>.Worker/Program.cs",
        "src/<ServiceName>.Worker/Worker.cs",
        "src/<ServiceName>.Worker/appsettings.json"
      ],
      "depends_on": [],
      "blocks": [],
      "estimated_minutes": 90,
      "agent_hint": "Create new project, migrate OnStart/OnStop to ExecuteAsync",
      "template_id": "migrate-windows-service",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "transform-004-migrate_config",
      "title": "Migrate Configuration",
      "description": "Move configuration from web.config/app.config to appsettings.json",
      "phase": "transform",
      "order": 4,
      "status": "pending",
      "instructions": [
        "### Create Configuration Files",
        "Create appsettings.json with appropriate structure",
        "Create appsettings.Development.json for local settings",
        "Create appsettings.Staging.json for staging environment",
        "Create appsettings.Production.json for production",
        "### Migrate Settings",
        "Migrate <appSettings> section to appsettings.json",
        "Migrate <connectionStrings> section",
        "Convert custom config sections to JSON",
        "Remove legacy config file references",
        "### Create Options Classes",
        "Create strongly-typed options classes for each section",
        "Add [Required] and validation attributes",
        "Register options in DI container using:",
        "  services.Configure<TOptions>(config.GetSection(\"...\"))",
        "Inject IOptions<T> or IOptionsSnapshot<T> as needed",
        "### Handle Secrets",
        "Move sensitive settings to user-secrets for development:",
        "  dotnet user-secrets init",
        "  dotnet user-secrets set \"Key\" \"Value\"",
        "Document Key Vault integration for production",
        "Update code to use IConfiguration or IOptions<T>",
        "### Update Code",
        "Replace ConfigurationManager.AppSettings usage",
        "Replace ConfigurationManager.ConnectionStrings usage",
        "Update to use IConfiguration or IOptions<T> pattern",
        "Remove System.Configuration.ConfigurationManager references"
      ],
      "acceptance_criteria": [
        "All configuration migrated to appsettings.json",
        "Strongly-typed options classes created",
        "No hardcoded configuration values in code",
        "No references to ConfigurationManager",
        "Application starts successfully with new configuration",
        "Secrets not committed to repository"
      ],
      "files_to_modify": [
        "**/*.csproj",
        "**/Program.cs",
        "**/Startup.cs"
      ],
      "files_to_create": [
        "src/**/appsettings.json",
        "src/**/appsettings.Development.json"
      ],
      "depends_on": [],
      "blocks": [],
      "estimated_minutes": 30,
      "agent_hint": "Good for coding agents - mostly mechanical transformation",
      "template_id": "migrate-config",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "transform-005-add_docker",
      "title": "Add Docker Support",
      "description": "Create Dockerfile for containerization of deployable projects",
      "phase": "transform",
      "order": 5,
      "status": "pending",
      "instructions": [
        "### Create Dockerfile",
        "Create Dockerfile using multi-stage build pattern",
        "Use official Microsoft .NET images:",
        "  Build stage: mcr.microsoft.com/dotnet/sdk:8.0",
        "  Runtime stage: mcr.microsoft.com/dotnet/aspnet:8.0 (for web apps)",
        "  Runtime stage: mcr.microsoft.com/dotnet/runtime:8.0 (for workers)",
        "Optimize layer caching by copying csproj first",
        "Set appropriate WORKDIR and EXPOSE ports",
        "### Create .dockerignore",
        "Create .dockerignore file in solution root",
        "Exclude build artifacts: bin/, obj/",
        "Exclude IDE files: .vs/, .idea/, *.user",
        "Exclude git history: .git/",
        "Exclude test results and coverage",
        "### Create Docker Compose",
        "Create docker-compose.yml for local development",
        "Add service definitions for each deployable project",
        "Add dependencies (SQL Server, Redis, etc.)",
        "Configure networking and volumes",
        "Create docker-compose.override.yml for local settings",
        "### Verify Container",
        "Build container image: docker build -t <app>:local .",
        "Run container: docker run -p 8080:8080 <app>:local",
        "Verify health check endpoint responds",
        "Test docker-compose up works end-to-end"
      ],
      "acceptance_criteria": [
        "Dockerfile builds successfully",
        "Container image size is optimized (multi-stage)",
        "Container runs and responds to health checks",
        ".dockerignore excludes appropriate files",
        "docker-compose up starts all services",
        "Local development workflow documented"
      ],
      "files_to_modify": [],
      "files_to_create": [
        "src/**/Dockerfile",
        ".dockerignore",
        "docker-compose.yml",
        "docker-compose.override.yml"
      ],
      "depends_on": [],
      "blocks": [],
      "estimated_minutes": 30,
      "agent_hint": "Good for coding agents - template-based generation",
      "template_id": "add-docker",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "validate-006-validate_build",
      "title": "Verify Solution Builds",
      "description": "Ensure entire solution builds without errors after transformations",
      "phase": "validate",
      "order": 6,
      "status": "pending",
      "instructions": [
        "### Build Solution",
        "Run 'dotnet build' on the solution file",
        "Capture and review all build output",
        "Note any build warnings for review",
        "### Fix Errors",
        "Address any compilation errors",
        "Resolve missing package references",
        "Fix type mismatches from framework changes",
        "Update deprecated API calls",
        "### Review Warnings",
        "Review nullable reference type warnings",
        "Address obsolete API usage warnings",
        "Fix analyzer warnings if configured"
      ],
      "acceptance_criteria": [
        "Solution builds with no errors",
        "No critical build warnings",
        "All projects included in build output"
      ],
      "files_to_modify": [
        "**/*.csproj",
        "**/*.cs"
      ],
      "files_to_create": [],
      "depends_on": [],
      "blocks": [
        "validate-007-validate_tests"
      ],
      "estimated_minutes": 15,
      "agent_hint": "Automated validation - run dotnet build",
      "template_id": "validate-build",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "validate-007-validate_tests",
      "title": "Run All Tests",
      "description": "Execute unit and integration tests to verify functionality",
      "phase": "validate",
      "order": 7,
      "status": "pending",
      "instructions": [
        "### Run Unit Tests",
        "Run 'dotnet test' on the solution",
        "Review test results and failures",
        "Identify tests that need updates for new APIs",
        "### Fix Failing Tests",
        "Update test assertions for changed behavior",
        "Fix mock configurations for new interfaces",
        "Update test data for new data structures",
        "### Review Coverage",
        "Run tests with coverage collection",
        "Identify areas with insufficient coverage",
        "Consider adding tests for new code paths"
      ],
      "acceptance_criteria": [
        "All unit tests pass",
        "All integration tests pass",
        "Code coverage meets minimum threshold (if configured)"
      ],
      "files_to_modify": [],
      "files_to_create": [],
      "depends_on": [
        "validate-006-validate_build"
      ],
      "blocks": [
        "validate-008-validate_security"
      ],
      "estimated_minutes": 20,
      "agent_hint": "Automated validation - run dotnet test",
      "template_id": "validate-tests",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "validate-008-validate_security",
      "title": "Security Scan",
      "description": "Run security analysis on codebase and dependencies",
      "phase": "validate",
      "order": 8,
      "status": "pending",
      "instructions": [
        "### Dependency Vulnerabilities",
        "Run 'dotnet list package --vulnerable' on solution",
        "Review any vulnerable packages identified",
        "Update vulnerable packages to patched versions",
        "Document any packages that cannot be updated",
        "### Static Analysis",
        "Run static security analysis tools",
        "Review SAST findings",
        "Address critical and high severity findings",
        "Document accepted risks for lower severity items",
        "### Secrets Detection",
        "Scan codebase for hardcoded secrets",
        "Verify connection strings use configuration",
        "Ensure API keys are externalized",
        "Check for secrets in committed files"
      ],
      "acceptance_criteria": [
        "No known vulnerable packages (or documented exceptions)",
        "No critical security findings",
        "No hardcoded secrets in codebase",
        "Secrets properly externalized to configuration"
      ],
      "files_to_modify": [],
      "files_to_create": [],
      "depends_on": [
        "validate-007-validate_tests"
      ],
      "blocks": [],
      "estimated_minutes": 20,
      "agent_hint": "Automated validation with human review of findings",
      "template_id": "validate-security",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "deploy-009-deploy_iac",
      "title": "Generate Infrastructure as Code",
      "description": "Create Bicep templates for Azure deployment",
      "phase": "deploy",
      "order": 9,
      "status": "pending",
      "instructions": [
        "### Create Main Template",
        "Create infrastructure/ directory structure",
        "Create main.bicep with resource definitions",
        "Define parameters for environment configuration",
        "Add metadata and description decorators",
        "### Create Modules",
        "Create module files for each resource type:",
        "  - modules/app-service.bicep (if using App Service)",
        "  - modules/container-app.bicep (if using Container Apps)",
        "  - modules/service-bus.bicep (if using messaging)",
        "  - modules/sql-database.bicep (if using SQL)",
        "  - modules/key-vault.bicep (for secrets)",
        "  - modules/app-insights.bicep (for monitoring)",
        "Use consistent parameter patterns across modules",
        "### Environment Configuration",
        "Create parameters/ directory",
        "Create parameters/dev.bicepparam for development",
        "Create parameters/staging.bicepparam for staging",
        "Create parameters/prod.bicepparam for production",
        "Externalize environment-specific values",
        "### Validate Templates",
        "Run 'az bicep build' to validate syntax",
        "Run what-if deployment to preview changes",
        "Review generated ARM template for correctness"
      ],
      "acceptance_criteria": [
        "Bicep templates validate without errors",
        "All required Azure resources defined",
        "Environment-specific parameters separated",
        "Private endpoints configured where applicable",
        "Managed identities used for authentication",
        "What-if deployment shows expected resources"
      ],
      "files_to_modify": [],
      "files_to_create": [
        "infrastructure/main.bicep",
        "infrastructure/modules/*.bicep",
        "infrastructure/parameters/dev.bicepparam",
        "infrastructure/parameters/staging.bicepparam",
        "infrastructure/parameters/prod.bicepparam"
      ],
      "depends_on": [],
      "blocks": [
        "deploy-010-deploy_pipeline"
      ],
      "estimated_minutes": 45,
      "agent_hint": "Good for coding agents with IaC/Bicep knowledge",
      "template_id": "deploy-iac",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    },
    {
      "id": "deploy-010-deploy_pipeline",
      "title": "Create CI/CD Pipeline",
      "description": "Set up GitHub Actions workflows for continuous integration and deployment",
      "phase": "deploy",
      "order": 10,
      "status": "pending",
      "instructions": [
        "### Create CI Workflow",
        "Create .github/workflows/ci.yml",
        "Configure workflow triggers (push, pull_request)",
        "Add build job with dotnet build",
        "Add test job with dotnet test",
        "Add security scan job",
        "Configure caching for NuGet packages",
        "### Create CD Workflow",
        "Create .github/workflows/cd.yml",
        "Configure trigger on main branch merge",
        "Add build and publish job",
        "Add deployment job for each environment",
        "Configure environment protection rules",
        "Add deployment approvals for staging/prod",
        "### Configure Secrets",
        "Document required GitHub secrets:",
        "  - AZURE_CREDENTIALS (service principal)",
        "  - AZURE_SUBSCRIPTION_ID",
        "  - AZURE_RESOURCE_GROUP",
        "Create secrets documentation in docs/",
        "### Test Workflows",
        "Validate workflow syntax with actionlint",
        "Create test branch and push",
        "Verify CI workflow executes",
        "Test deployment to dev environment"
      ],
      "acceptance_criteria": [
        "CI workflow runs on pull requests",
        "CI workflow includes build, test, and security scan",
        "CD workflow deploys to dev on merge to main",
        "Staging and production require manual approval",
        "Rollback procedure documented",
        "Secrets documentation created"
      ],
      "files_to_modify": [],
      "files_to_create": [
        ".github/workflows/ci.yml",
        ".github/workflows/cd.yml",
        "docs/deployment/secrets.md",
        "docs/deployment/rollback.md"
      ],
      "depends_on": [
        "deploy-009-deploy_iac"
      ],
      "blocks": [],
      "estimated_minutes": 60,
      "agent_hint": "Good for coding agents - YAML workflow generation",
      "template_id": "deploy-pipeline",
      "started_at": null,
      "completed_at": null,
      "result": null,
      "branch": null,
      "pr_url": null
    }
  ]
}